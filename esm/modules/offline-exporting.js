/**
 * Highcharts JS v12.4.0-modified (2025-09-05)
 * @module highcharts/modules/offline-exporting
 * @requires highcharts
 * @requires highcharts/modules/exporting
 *
 * Client side exporting module
 *
 * (c) 2015-2025 Torstein Honsi / Oystein Moseng
 *
 * License: www.highcharts.com/license
 */import*as t from"../highcharts.js";import"./exporting.js";var e,o={};o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},o.d=(t,e)=>{for(var r in e)o.o(e,r)&&!o.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);let r=t.default;var a=o.n(r);let{isSafari:n,win:l,win:{document:i}}=a(),{error:d}=a(),s=l.URL||l.webkitURL||l;function c(t){let e=t.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([A-Z+\d\/]+)/i);if(e&&e.length>3&&l.atob&&l.ArrayBuffer&&l.Uint8Array&&l.Blob&&s.createObjectURL){let t=l.atob(e[3]),o=new l.ArrayBuffer(t.length),r=new l.Uint8Array(o);for(let e=0;e<r.length;++e)r[e]=t.charCodeAt(e);return s.createObjectURL(new l.Blob([r],{type:e[1]}))}}let f={dataURLtoBlob:c,downloadURL:function(t,e){let o=l.navigator,r=i.createElement("a");if("string"!=typeof t&&!(t instanceof String)&&o.msSaveOrOpenBlob)return void o.msSaveOrOpenBlob(t,e);if(t=""+t,o.userAgent.length>1e3)throw Error("Input too long");let a=/Edge\/\d+/.test(o.userAgent);if((n&&"string"==typeof t&&0===t.indexOf("data:application/pdf")||a||t.length>2e6)&&!(t=c(t)||""))throw Error("Failed to convert to blob");if(void 0!==r.download)r.href=t,r.download=e,i.body.appendChild(r),r.click(),i.body.removeChild(r);else try{if(!l.open(t,"chart"))throw Error("Failed to open window")}catch{l.location.href=t}},getScript:function(t){return new Promise((e,o)=>{let r=i.getElementsByTagName("head")[0],a=i.createElement("script");a.type="text/javascript",a.src=t,a.onload=()=>{e()},a.onerror=()=>{let e=`Error loading script ${t}`;d(e),o(Error(e))},r.appendChild(a)})}},p=t.default.AST;var h=o.n(p);let u=t.default.Chart;var g=o.n(u);let y={exporting:{}},{getOptions:m,setOptions:w}=a(),{downloadURL:b,getScript:v}=f,{composed:E,doc:F,win:x}=a(),{addEvent:S,extend:A,pushUnique:L}=a();!function(t){async function e(t,e,a,n){let l=function(t,e){let o,r,a=F.createElement("div");h().setElementHTML(a,t);let n=a.getElementsByTagName("text"),l=function(t,e){let o=t;for(;o&&o!==a;){if(o.style[e]){let r=o.style[e];"fontSize"===e&&/em$/.test(r)&&(r=Math.round(16*parseFloat(r))+"px"),t.style[e]=r;break}o=o.parentNode}};return[].forEach.call(n,function(t){for(["fontFamily","fontSize"].forEach(e=>{l(t,e)}),t.style.fontFamily=e?.normal?"HighchartsFont":String(t.style.fontFamily&&t.style.fontFamily.split(" ").splice(-1)),o=t.getElementsByTagName("title"),[].forEach.call(o,function(e){t.removeChild(e)}),r=t.getElementsByClassName("highcharts-text-outline");r.length>0;){let t=r[0];t.parentNode&&t.parentNode.removeChild(t)}}),a.querySelector("svg")}(t,n);l&&(await o(l,n),b(await r(l,0,e),a))}async function o(t,e){let o,r,a=(t,e)=>{x.jspdf.jsPDF.API.events.push(["initialized",function(){this.addFileToVFS(t,e),this.addFont(t,"HighchartsFont",t),this.getFontList()?.HighchartsFont||this.setFont("HighchartsFont")}])};for(let n of(e&&(r=t.textContent||"",!/[^\u0000-\u007F\u200B]+/.test(r))&&(e=void 0),["normal","italic","bold","bolditalic"])){let t=e?.[n];if(t)try{let e=await x.fetch(t);if(!e.ok)throw Error(`Failed to fetch font: ${t}`);let r=await e.blob(),l=new FileReader,i=await new Promise((t,e)=>{l.onloadend=()=>{"string"==typeof l.result?t(l.result.split(",")[1]):e(Error("Failed to read font as base64"))},l.onerror=e,l.readAsDataURL(r)});a(n,i),"normal"===n&&(o=i)}catch{}else o&&a(n,o)}}async function r(t,e,o){let r=(Number(t.getAttribute("width"))+2*e)*o,a=(Number(t.getAttribute("height"))+2*e)*o,n=new x.jspdf.jsPDF(a>r?"p":"l","pt",[r,a]);[].forEach.call(t.querySelectorAll('*[visibility="hidden"]'),function(t){t.parentNode.removeChild(t)});let l=t.querySelectorAll("linearGradient");for(let t=0;t<l.length;t++){let e=l[t].querySelectorAll("stop"),o=0;for(;o<e.length&&"0"===e[o].getAttribute("offset")&&"0"===e[o+1].getAttribute("offset");)e[o].remove(),o++}return[].forEach.call(t.querySelectorAll("tspan"),t=>{"â€‹"===t.textContent&&(t.textContent=" ",t.setAttribute("dx",-5))}),await n.svg(t,{x:0,y:0,width:r,height:a,removeInvalid:!0}),n.output("datauristring")}t.compose=function(t){if(S(t,"downloadSVG",async function(t){let{svg:o,exportingOptions:r,exporting:n,preventDefault:l}=t;if(r?.type==="application/pdf"){l?.();try{let{type:t,filename:n,scale:l,libURL:i}=a().Exporting.prepareImageOptions(r);"application/pdf"===t&&(x.jspdf?.jsPDF||(await v(`${i}jspdf.js`),await v(`${i}svg2pdf.js`)),await e(o,l,n,r?.pdfFont))}catch(t){await n?.fallbackToServer(r,t)}}}),!L(E,"OfflineExporting"))return;A(g().prototype,{exportChartLocal:async function(t,e){await this.exporting?.exportChart(t,e)}}),w(y);let o=m().exporting?.buttons?.contextButton?.menuItems;o&&o.push("downloadPDF")},t.downloadSVGLocal=async function(t,e){await a().Exporting.prototype.downloadSVG.call(void 0,t,e)}}(e||(e={}));let j=e;o.d({},{});let B=a();B.dataURLtoBlob=B.dataURLtoBlob||f.dataURLtoBlob,B.downloadSVGLocal=j.downloadSVGLocal,B.downloadURL=B.downloadURL||f.downloadURL,j.compose(B.Exporting);let U=a();export{U as default};